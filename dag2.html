<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>DAG 2 (DA‚ÜíRU)</title>
<style>
body { font-family: sans-serif; line-height: 1.6; margin: 20px; }
.word { border: 1px solid #ccc; border-radius: 8px; padding: 12px; margin-bottom: 12px; }
.hidden { display: none; }
input[type="text"] { padding: 5px; margin: 3px; width: 120px; }
button { margin-left: 5px; padding: 5px 10px; }
.correct { background-color: #c8f7c5; } /* –∑–µ–ª—ë–Ω—ã–π */
.wrong { background-color: #f7c5c5; }   /* –∫—Ä–∞—Å–Ω—ã–π */
.wordSpan { margin-right: 3px; }
.speedControl { margin-left: 10px; }
</style>
</head>
<body>
<h2>DAG 2 (DA‚ÜíRU)</h2>
<label><input type="checkbox" id="toggleWords"> Skjul alle ord</label>
<label><input type="checkbox" id="toggleTranslations"> Skjul alle overs√¶ttelser</label>

<div id="wordsContainer"></div>

<script>
const words = [
  { da: "afg√∏re", ru: "—Ä–µ—à–∏—Ç—å / –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å", ex: "Dommeren skal ___ kampen. Vi m√• ___, hvad vi g√∏r nu.", parts: ["afg√∏re", "afg√∏re"] },
  { da: "Brockdalebroen", ru: "–ë—Ä–æ–∫–¥–µ–π–ª—Å–∫–∏–π –º–æ—Å—Ç", ex: "___ kollapsede i historien. Mange mennesker husker ___.", parts: ["Brockdalebroen", "Brockdalebroen"] },
  { da: "afsl√∏re", ru: "—Ä–∞–∑–æ–±–ª–∞—á–∏—Ç—å / —Ä–∞—Å–∫—Ä—ã—Ç—å", ex: "Journalisten kunne ___ sandheden. Hun vil ___ sin hemmelighed.", parts: ["afsl√∏re", "afsl√∏re"] },
  { da: "begejstret", ru: "–≤ –≤–æ—Å—Ç–æ—Ä–≥–µ / –≤–æ–æ–¥—É—à–µ–≤–ª—ë–Ω–Ω—ã–π", ex: "Han er meget ___. Publikum var ___ efter koncerten.", parts: ["begejstret", "begejstret"] },
  { da: "involvere", ru: "–≤–æ–≤–ª–µ–∫–∞—Ç—å / –≤–∫–ª—é—á–∞—Ç—å", ex: "Projektet vil ___ mange elever. Vi skal ___ for√¶ldrene i m√∏det.", parts: ["involvere", "involvere"] },
  { da: "udvidende", ru: "—Ä–∞—Å—à–∏—Ä—è—é—â–∏–π—Å—è / —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π", ex: "Virksomheden er ___ p√• markedet. Hans horisont blev ___ gennem studiet.", parts: ["udvidende", "udvidende"] },
  { da: "stift", ru: "—Ç–≤—ë—Ä–¥—ã–π / –∂—ë—Å—Ç–∫–∏–π", ex: "Stolen f√∏ltes ___. Han sad meget ___.", parts: ["stift", "stift"] },
  { da: "hentydningen", ru: "–Ω–∞–º—ë–∫", ex: "Jeg forstod ikke ___. Hun lo af ___.", parts: ["hentydningen", "hentydningen"] },
  { da: "gebestanden", ru: "–ø–æ—Ä—É—á–µ–Ω–∏—è / –≤–æ–∑–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏", ex: "Han tog imod de ___. Professoren gav ham flere ___.", parts: ["gebestanden", "gebestanden"] },
  { da: "lamsl√•ede", ru: "–æ—à–µ–ª–æ–º–ª—ë–Ω–Ω—ã–µ / –ø–æ—Ç—Ä—è—Å—ë–Ω–Ω—ã–µ", ex: "Publikum var helt ___. Vi stod ___ og kunne ikke reagere.", parts: ["lamsl√•ede", "lamsl√•ede"] },
  { da: "fupnummer", ru: "–æ–±–º–∞–Ω / —Ç—Ä—é–∫", ex: "Han brugte et ___. Tryllekunstneren lavede et ___.", parts: ["fupnummer", "fupnummer"] },
  { da: "vanskelig", ru: "—Ç—Ä—É–¥–Ω—ã–π / —Å–ª–æ–∂–Ω—ã–π", ex: "Det er en ___ opgave. Situationen var ___ for alle.", parts: ["vanskelig", "vanskelig"] },
  { da: "befolkning", ru: "–Ω–∞—Å–µ–ª–µ–Ω–∏–µ", ex: "Danmarks ___ er ca. 6 millioner. Byens ___ voksede hurtigt.", parts: ["befolkning", "befolkning"] },
  { da: "smaragdr√∏mme", ru: "–∏–∑—É–º—Ä—É–¥–Ω—ã–µ —Å–Ω—ã", ex: "Hun havde m√¶rkelige ___. De talte om hans ___.", parts: ["smaragdr√∏mme", "smaragdr√∏mme"] },
  { da: "umuligt", ru: "–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ", ex: "Det er helt ___. At flyve uden vinger er ___.", parts: ["umuligt", "umuligt"] },
  { da: "opr√∏r", ru: "–≤–æ—Å—Å—Ç–∞–Ω–∏–µ / –±—É–Ω—Ç", ex: "Der var et ___ i landet. Eleverne lavede ___ mod l√¶reren.", parts: ["opr√∏r", "opr√∏r"] },
  { da: "√∏jeblikkelige", ru: "–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ / –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ", ex: "Han kr√¶vede ___ svar. Der kom ___ reaktioner.", parts: ["√∏jeblikkelige", "√∏jeblikkelige"] },
  { da: "mudderbrunt", ru: "–≥—Ä—è–∑–Ω–æ-–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π / –º—É—Ç–Ω–æ-–±—É—Ä—ã–π", ex: "Hun bar en ___ frakke. Vandet var blevet ___.", parts: ["mudderbrunt", "mudderbrunt"] },
  { da: "n√•ede", ru: "–¥–æ—Å—Ç–∏–≥ / —É—Å–ø–µ–ª", ex: "Han ___ toget i tide. Hun ___ toppen af bjerget.", parts: ["n√•ede", "n√•ede"] },
  { da: "h√¶ldte", ru: "–Ω–∞–ª–∏–ª / –≤—ã–ª–∏–ª", ex: "Hun ___ vand i glasset. Han ___ kaffen ud.", parts: ["h√¶ldte", "h√¶ldte"] },
  { da: "tryllestav", ru: "–≤–æ–ª—à–µ–±–Ω–∞—è –ø–∞–ª–æ—á–∫–∞", ex: "Hun viftede med sin ___. Harry Potter har en ___.", parts: ["tryllestav", "tryllestav"] },
  { da: "fremmanet", ru: "–≤—ã–∑–≤–∞–Ω–Ω—ã–π / —Å–æ—Ç–≤–æ—Ä—ë–Ω–Ω—ã–π", ex: "Billedet var ___. Troldmanden havde ___ en √•nd.", parts: ["fremmanet", "fremmanet"] },
  { da: "fudge", ru: "–∏—Ä–∏—Å–∫–∞ / –ø–æ–º–∞–¥–∫–∞", ex: "Jeg k√∏bte ___ i butikken. Hun spiste et stykke ___.", parts: ["fudge", "fudge"] },
  { da: "h√•bl√∏st", ru: "–±–µ–∑–Ω–∞–¥—ë–∂–Ω–æ", ex: "Situationen er ___. Han k√¶mpede ___ mod overmagten.", parts: ["h√•bl√∏st", "h√•bl√∏st"] },
  { da: "ravgylden", ru: "—è–Ω—Ç–∞—Ä–Ω–æ-–∑–æ–ª–æ—Ç–æ–π", ex: "Hun bar en ___ halsk√¶de. Solen kastede et ___ lys.", parts: ["ravgylden", "ravgylden"] },
  { da: "bet√∏d", ru: "–æ–∑–Ω–∞—á–∞–ª–æ / –∑–Ω–∞—á–∏–ª–æ", ex: "Ordet ___ noget helt andet. Det ___ meget for hende.", parts: ["bet√∏d", "bet√∏d"] }
];



const container = document.getElementById("wordsContainer");

words.forEach((w, idx) => {
  const div = document.createElement("div");
  div.className = "word";

  const da = document.createElement("div");
  da.className = "daWord";
  da.textContent = "DA: " + w.da;

  const ru = document.createElement("div");
  ru.className = "ruWord";
  ru.textContent = "RU: " + w.ru;

  const exDiv = document.createElement("div");

  if (w.da.includes("...") && w.parts.length === 2) {
    const exParts = w.ex.split("___");
    
    const span1 = document.createElement("span");
    span1.textContent = exParts[0];
    exDiv.appendChild(span1);

    const input1 = document.createElement("input");
    input1.type = "text";
    input1.dataset.word = w.parts[0].toLowerCase();
    input1.className = "wordPart";
    exDiv.appendChild(input1);

    const spanMid = document.createElement("span");
    spanMid.textContent = exParts[1];
    exDiv.appendChild(spanMid);

    const input2 = document.createElement("input");
    input2.type = "text";
    input2.dataset.word = w.parts[1].toLowerCase();
    input2.className = "wordPart";
    exDiv.appendChild(input2);

    const spanEnd = document.createElement("span");
    spanEnd.textContent = exParts[2] ? exParts[2] : "";
    exDiv.appendChild(spanEnd);

  } else {
    let partIdx = 0;
    w.ex.split(" ").forEach(word => {
      if (word.includes("___")) {
        const wordsArray = w.parts[partIdx].split(" ");
        wordsArray.forEach(wPart => {
          const input = document.createElement("input");
          input.type = "text";
          input.dataset.word = wPart.toLowerCase();
          input.className = "wordPart";
          exDiv.appendChild(input);
          exDiv.appendChild(document.createTextNode(" "));
        });
        partIdx++;
      } else {
        const span = document.createElement("span");
        span.textContent = word;
        span.className = "wordSpan";
        span.dataset.word = word.replace(/[.,!?]/g, "").toLowerCase();
        exDiv.appendChild(span);
        exDiv.appendChild(document.createTextNode(" "));
      }
    });
  }

  const checkBtn = document.createElement("button");
  checkBtn.textContent = "Tjek";
  checkBtn.onclick = () => {
    const inputs = exDiv.querySelectorAll("input");
    let allCorrect = true;
    inputs.forEach(inp => {
      const correctWords = inp.dataset.word.toLowerCase().split(" ");
      const userWords = inp.value.trim().toLowerCase().split(" ");
      const isCorrect = correctWords.length === userWords.length &&
                        correctWords.every((w,i)=>w===userWords[i]);
      if(isCorrect){
        inp.classList.add("correct");
        inp.classList.remove("wrong");
      } else {
        inp.classList.add("wrong");
        inp.classList.remove("correct");
        allCorrect = false;
      }
    });
    const result = document.createElement("div");
    result.className = allCorrect ? "correct" : "wrong";
    result.textContent = allCorrect ? "Korrekt!" : "Forkert!";
    exDiv.appendChild(result);
    setTimeout(()=>result.remove(),1500);
  };

  const micBtn = document.createElement("button");
  micBtn.textContent = "üéôÔ∏è L√¶s h√∏jt";
  micBtn.onclick = () => {
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = "da-DK";
    recognition.interimResults = false;
    recognition.start();
    recognition.onresult = event => {
      const spoken = event.results[0][0].transcript.toLowerCase();
      exDiv.querySelectorAll("span, input").forEach(el => {
        const word = el.dataset.word;
        if(word && spoken.includes(word)){
          el.classList.add("correct");
          el.classList.remove("wrong");
        } else if(word){
          el.classList.add("wrong");
          el.classList.remove("correct");
        }
      });
    };
    recognition.onerror = err => console.error("SpeechRecognition error:", err);
  };

  const playOrigBtn = document.createElement("button");
  playOrigBtn.textContent = "‚ñ∂Ô∏è H√∏r original";
  
  const speedWrapper = document.createElement("div");
  speedWrapper.style.display = "flex";
  speedWrapper.style.alignItems = "center";
  speedWrapper.style.gap = "6px";

  const speedSlider = document.createElement("input");
  speedSlider.type = "range";
  speedSlider.min = "0.5";
  speedSlider.max = "1.5";
  speedSlider.step = "0.1";
  speedSlider.value = "1";
  speedSlider.className = "speedControl";

  const speedLabel = document.createElement("span");
  speedLabel.textContent = speedSlider.value + "x";
  speedLabel.style.fontSize = "0.9em";
  speedLabel.style.color = "#444";

  speedSlider.addEventListener("input", () => {
    speedLabel.textContent = speedSlider.value + "x";
  });

  playOrigBtn.onclick = () => {
    let sentence = w.ex;
    w.parts.forEach(part => {
      sentence = sentence.replace("___", part);
    });

    const utterance = new SpeechSynthesisUtterance(sentence);
    utterance.lang = "da-DK";
	utterance.rate = parseFloat(speedSlider.value);
    window.speechSynthesis.speak(utterance);
  };


  div.appendChild(da);
  div.appendChild(ru);
  div.appendChild(exDiv);
  div.appendChild(checkBtn);
  div.appendChild(micBtn);
  div.appendChild(playOrigBtn);

  speedWrapper.appendChild(speedSlider);
  speedWrapper.appendChild(speedLabel);
  div.appendChild(speedWrapper);

  container.appendChild(div);
});

document.getElementById("toggleWords").onchange = e => {
  document.querySelectorAll(".daWord").forEach(d => d.classList.toggle("hidden", e.target.checked));
};
document.getElementById("toggleTranslations").onchange = e => {
  document.querySelectorAll(".ruWord").forEach(d => d.classList.toggle("hidden", e.target.checked));
};
</script>
</body>
</html>
